function wcpaInitMap(){var e={street_number:"short_name",route:"long_name",locality:"long_name",administrative_area_level_1:"short_name",country:"long_name",postal_code:"short_name"};jQuery(".wcpa_type_placeselector").each((function(){var a=jQuery(this).find(".wcpa_google_place").get(0),t=jQuery(this),i=new google.maps.places.Autocomplete(a);""!=wcpa_global_vars.google_map_countries&&Array.isArray(wcpa_global_vars.google_map_countries)&&i.setComponentRestrictions({country:wcpa_global_vars.google_map_countries});var r=new google.maps.Geocoder;if(i.addListener("place_changed",(function(){var a=i.getPlace();for(var r in e)jQuery("."+r,t).val(""),jQuery("."+r,t).removeAttr("disabled","disabled");for(var n=0;n<a.address_components.length;n++){var c=a.address_components[n].types[0];if(e[c]){var p=a.address_components[n][e[c]];jQuery("."+c,t).val(p)}}a.geometry&&(jQuery(".wcpa_lat",t).val(a.geometry.location.lat()),jQuery(".wcpa_lng",t).val(a.geometry.location.lng()))})),t.find(".wcpa_map").length){var n=new google.maps.Map(t.find(".wcpa_map").get(0),{center:{lat:0,lng:0},zoom:15});i.bindTo("bounds",n);var c=new google.maps.Marker({map:n,draggable:!0,anchorPoint:new google.maps.Point(0,-29)});jQuery.post("https://www.googleapis.com/geolocation/v1/geolocate?key="+wcpa_global_vars.google_map_api,(function(e){n.setCenter(e.location),c.setVisible(!1),c.setPosition(e.location),c.setVisible(!0)})),google.maps.event.addListener(c,"dragend",(function(){jQuery(".wcpa_lat",t).val(c.getPosition().lat()),jQuery(".wcpa_lng",t).val(c.getPosition().lng()),r.geocode({latLng:c.getPosition()},(function(a){for(var i in e)jQuery("."+i,t).val(""),jQuery("."+i,t).removeAttr("disabled","disabled");if(a&&a.length>0){jQuery(".wcpa_google_place",t).val(a[0].formatted_address),jQuery.wcpaIterate();for(var r=0;r<a[0].address_components.length;r++){var n=a[0].address_components[r].types[0];if(e[n]){var c=a[0].address_components[r][e[n]];jQuery("."+n,t).val(c)}}}}))})),i.addListener("place_changed",(function(){c.setVisible(!1);var e=i.getPlace();e.geometry?(e.geometry.viewport?n.fitBounds(e.geometry.viewport):(n.setCenter(e.geometry.location),n.setZoom(17)),c.setPosition(e.geometry.location),c.setVisible(!0)):window.alert("No details available for input: '"+e.name+"'")}))}}))}String.prototype.endsWith||(String.prototype.endsWith=function(e,a){return(void 0===a||a>this.length)&&(a=this.length),this.substring(a-e.length,a)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e,a){return this.substr(!a||a<0?0:+a,e.length)===e}),function($){function wcpa_product_image_update(e,a){if(0!=a){var t=a.data("image"),i={image:t};$.extend(i,{image:t}),null!=t.image_id&&$.extend(i,{image_id:t.image_id}),e.wc_variations_image_update(i),e.data("wcpa_product_image",!0);var r,n=e.closest(".product, .product-col"),c=n.find(".product-image-slider"),p=n.find(".product-thumbs-slider");c.length&&c.trigger("to.owl.carousel",[0,100,!0]),p.length&&p.trigger("to.owl.carousel",[0,100,!0]),(r=n.find("div.product-images .woocommerce-main-image").length?n.find("div.product-images .woocommerce-main-image"):$(".single-product div.product-images .woocommerce-main-image"))&&r.length&&(r.attr("src",t.src),r.attr("srcset",""),r.attr("alt",t.title),r.attr("href",t.full_src)),e.find(".wcpa_form_outer").trigger("wcpa_product_image_changed",[i]),(r=n.find(".product-gallery a img").first())&&(r.attr("src",t.src),r.attr("srcset",""),r.attr("alt",t.title),r.attr("href",t.full_src))}else 1==e.data("wcpa_product_image")&&(e.wc_variations_image_update(!1),e.data("wcpa_product_image",!1),e.find(".variations select").trigger("change"))}function wcpa_remove_file(e){!0===e.data("details").required&&e.attr("required","required");var a=e.parents(".wcpa_file_outer");$preview=e.parents(".wcpa_form_item").find(".wcpa_upload_preview"),$preview.length&&$preview.html(""),$("~ .wcpa_progress",a).hide().css("width",0),$("~ .wcpa_file_hidden",a).val(""),e.parent().removeClass("wcpa_uploaded"),e.val(""),e.trigger("change"),a.find(".wcpa_file_name").removeClass("wcpa_file_error").html(""),iterate(e.parents(".wcpa_form_outer"))}function wcpa_upload_file(e){var a,t=e.prop("files"),i=!1,r=e.parents(".wcpa_file_outer");if(e.hasClass("wcpa_multiple")?i=!0:a=t[0],void 0!==a||i){if("object"==typeof e.data("wcpa_ajx_upload")&&e.data("wcpa_ajx_upload").abort(),$("[id="+e.attr("id")+"]").length>1){var n=$("[id="+e.attr("id")+"]:visible");n.length&&(e=n)}var c="";if(i){if(!t.length)return void r.find(".wcpa_file_name").removeClass("wcpa_file_error").html(c);$.each(t,((e,a)=>{c+=a.name+", "})),c=c.substring(0,c.length-2)}else{var p=e.val().match(/([^\/\\]+)$/);c=p[1]}if(r.find(".wcpa_file_name").removeClass("wcpa_file_error").html(c),$preview=e.parents(".wcpa_form_item").find(".wcpa_upload_preview"),$preview.length)if(i)t.length&&($preview.html(""),$.each(t,((e,a)=>{var t=new FileReader,i=a.name.split("."),r=i[i.length-1];["jpg","jpeg","png","gif","svg"].indexOf(r.toLowerCase())>-1&&(t.onload=function(a){$preview.hasClass("wcpa_no_preview_multiple")?$preview.append("<div class='wcpa_preview_block' id='wcpa_ajax_file_upload_preview_block_"+e+"'><div class='wcpa_progress' style='width:0;display:block;'></div></div>"):$preview.append("<div class='wcpa_preview_block' id='wcpa_ajax_file_upload_preview_block_"+e+"'><div class='wcpa_progress' style='width:0;display:block;'></div><img src='"+a.target.result+"' /></div>")},t.readAsDataURL(a))})));else if(a){var l=new FileReader,s=a.name.split("."),o=s[s.length-1];["jpg","jpeg","png","gif","svg"].indexOf(o.toLowerCase())>-1?(l.onload=function(e){$preview.html($("<img />").attr("src",e.target.result))},l.readAsDataURL(a)):$preview.html("")}if(e.is(".wcpa_ajax_upload")){var _;if(i){if(t.length){var d=[],u=!1;$.each(t,((a,i)=>{var n=new FormData,c=e.data("details");n.append("wcpa_file_details",JSON.stringify(c)),n.append("action","wcpa_ajax_upload"),!0===c.required&&e.attr("required","required"),n.append("wcpa_file",i),_=$.ajax({type:"POST",url:wcpa_global_vars.ajax_url,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);$("#wcpa_ajax_file_upload_preview_block_"+a+" .wcpa_progress").css("width",t+"%")}}),!1),e},beforeSend:function(){u||(e.parents(".wcpa_form_item").addClass("wcpa_uploading"),e.parent().removeClass("wcpa_uploaded"),$("~ .wcpa_file_hidden",r).val(""),e.parents("form").find("button[name=add-to-cart]").addClass("wcpa_disable_cart"),e.prop("disabled",!0)),$("~ .wcpa_remove_file",r).hide(),$("#wcpa_ajax_file_upload_preview_block_"+a+" .wcpa_progress").show().css("width",0);var t=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(t)?t=1:t++,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",t),d[a]="true",u=!0},success:function(n){var c=$("~ .wcpa_file_hidden",r).val(),p=n.status?n.file.file+"||"+n.file.file_name:null,l=[];(l=c?JSON.parse(c):[])[a]=p;var s=JSON.stringify(l);if($("~ .wcpa_file_hidden",r).val(s).trigger("change"),!0===n.status)$("#wcpa_ajax_file_upload_preview_block_"+a+" .wcpa_progress").show().css("width","100%"),$("#wcpa_ajax_file_upload_preview_block_"+a+" .wcpa_progress").show();else{$("#wcpa_ajax_file_upload_preview_block_"+a).html('<div class="wcpa_file_error">'+i.name+" "+wcpa_global_vars.strings.ajax_upload_error+", "+n.message+"</div>");var o="",_=r.find(".wcpa_file_name").html();t.length&&($.each(t,((e,a)=>{a.name!==i.name&&-1!=_.indexOf(a.name)&&(o+=a.name+", ")})),o=o.substring(0,o.length-2)),r.find(".wcpa_file_name").html(o)}d[a]="false",-1===$.inArray("true",d)?(u=!1,$("~ .wcpa_remove_file",r).show(),e.parents(".wcpa_form_item").removeClass("wcpa_uploading"),e.val(""),e.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart"),!0===n.status&&(e.parent().addClass("wcpa_uploaded"),e.removeAttr("required")),e.prop("disabled",!1)):$("~ .wcpa_remove_file",r).hide();var f=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(f)||1===f?f=0:f--,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",f)},error:function(n,c,p){$("#wcpa_ajax_file_upload_preview_block_"+a+" .wcpa_progress").show().css("width",0);var l=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(l)||1===l?l=0:l--,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",l),"abort"!==p&&(e.val(""),$("#wcpa_ajax_file_upload_preview_block_"+a).html('<div class="wcpa_file_error">'+i.name+" "+ +wcpa_global_vars.strings.ajax_upload_error+"</div>")),d[a]="false",-1===$.inArray("true",d)&&(e.parents(".wcpa_form_item").removeClass("wcpa_uploading"),e.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart"));var s="";t.length&&($.each(t,((e,a)=>{a.name!==i.name&&(s+=a.name+", ")})),s=s.substring(0,s.length-2)),r.find(".wcpa_file_name").html(s)},async:!0,data:n,dataType:"json",cache:!1,contentType:!1,processData:!1}),iterate(e.parents(".wcpa_form_outer"))}))}}else{var f=new FormData,m=e.data("details");f.append("wcpa_file_details",JSON.stringify(m)),f.append("action","wcpa_ajax_upload"),!0===m.required&&e.attr("required","required"),f.append("wcpa_file",a),_=$.ajax({type:"POST",url:wcpa_global_vars.ajax_url,xhr:function(){var e=$.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var a=Math.round(100*e.loaded/e.total);$("~ .wcpa_progress",r).css("width",a+"%")}}),!1),e},beforeSend:function(){e.parents(".wcpa_form_item").addClass("wcpa_uploading"),e.parent().removeClass("wcpa_uploaded"),$("~ .wcpa_progress",r).show().css("width",0),$("~ .wcpa_file_hidden",r).val(""),e.parents("form").find("button[name=add-to-cart]").addClass("wcpa_disable_cart");var a=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(a)?a=1:a++,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",a)},success:function(a){$("~ .wcpa_progress",r).show().css("width",100),e.parents(".wcpa_form_item").removeClass("wcpa_uploading"),$("~ .wcpa_progress",r).show(),e.val("");var t=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(t)||1===t?(t=0,e.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart")):t--,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",t),!0===a.status?(e.removeAttr("required"),$("~ .wcpa_progress",r).css("width","100%"),$("~ .wcpa_file_hidden",r).val(a.file.file+"||"+a.file.file_name).trigger("change"),e.parent().addClass("wcpa_uploaded")):($("~ .wcpa_progress",r).css("width",0),r.find(".wcpa_file_name").addClass("wcpa_file_error").html(a.message))},error:function(a,t,i){$("~ .wcpa_progress",r).show().css("width",0);var n=parseInt(e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(n)||1===n?(n=0,e.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart")):n--,e.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",n),"abort"!==i&&(e.val(""),r.find(".wcpa_file_name").addClass("wcpa_file_error").html(wcpa_global_vars.strings.ajax_upload_error)),e.parents(".wcpa_form_item").removeClass("wcpa_uploading")},async:!0,data:f,dataType:"json",cache:!1,contentType:!1,processData:!1}),iterate(e.parents(".wcpa_form_outer"))}e.data("wcpa_ajx_upload",_)}}else r.find(".wcpa_file_name").removeClass("wcpa_file_error").html("")}$.fn.wcpa_serializeArrayAll=function(){var e=/\r?\n/g,a=this.map((function(){return this.elements?jQuery.makeArray(this.elements):this})).map((function(a,t){var i=jQuery(this).val();return null==i?null==i:"checkbox"!=this.type&&"radio"!==this.type?"select-multiple"==this.type?jQuery.map(i,((a,t)=>({name:this.name.replace("[]",`[${t}]`),value:a.replace(e,"\r\n")}))):jQuery.isArray(i)?jQuery.map(i,(function(a,i){return{name:t.name,value:a.replace(e,"\r\n")}})):{name:t.name,value:i.replace(e,"\r\n")}:!0===this.checked?{name:this.name,value:this.value}:void 0})).get();return Object.values(a.reduce(((e,a)=>{var t=a.name,i=a.value,r=e[t]?e[t].value:"";return e[t]={name:t,value:""===i&&""!==r?r:i},e}),{})).filter((function(e){return""!=e.name}))};var wcpa_drag_upload_flag=!1;function drag_and_drop_file_upload_events(){$(document).on("dragover","html",(function(e){$("html").find(".wcpa_drag_drop").length&&(e.preventDefault(),e.stopPropagation(),$(".wcpa_drag_drop .wcpa-upload-area .upload-area-title").find(".upload-area-subtitle").show(),$(".wcpa_drag_drop .wcpa-upload-area .upload-area-title").find(".wcpa_drop_text").hide())})),$(document).on("drop","html",(function(e){$("html").find(".wcpa_drag_drop").length&&(e.preventDefault(),e.stopPropagation())})),$(document).on("dragenter dragover",".wcpa_drag_drop .wcpa-upload-area",(function(e){e.stopPropagation(),e.preventDefault(),$(this).find(".upload-area-subtitle").hide(),$(this).find(".wcpa_drop_text").show()})),$(document).on("ondragleave",".wcpa_drag_drop .wcpa-upload-area",(function(e){e.stopPropagation(),e.preventDefault(),$(this).find(".upload-area-subtitle").show(),$(this).find(".wcpa_drop_text").hide()})),$(".wcpa_drag_drop .upload-area-title .upload-area-subtitle span, .wcpa_drag_drop .upload-area-title-thumb-inner span").on("click",(function(e){e.preventDefault(),e.stopPropagation();var a="";$(this).parents(".wcpa_drag_drop").find("input.wcpa_multiple").length>0&&(a="multiple"),$(this).parents(".wcpa_drag_drop").find("input.wcpa_dynamic_file_uploader").length<=0&&$(this).parents(".wcpa_drag_drop").append('<input type="file" class="wcpa_dynamic_file_uploader" '+a+">"),$(this).parents(".wcpa_drag_drop").find("input.wcpa_dynamic_file_uploader").click()})),$(document).on("change onblur",".wcpa_drag_drop input.wcpa_dynamic_file_uploader",(function(e){var a=e.target.files;e.target.value.length&&wcpa_manageUploadFile($(this),a),$(this).remove()})),$(document).on("drop",".wcpa_drag_drop .wcpa-upload-area",(function(e){e.stopPropagation(),e.preventDefault(),$(this).find(".upload-area-subtitle").show(),$(this).find(".wcpa_drop_text").hide();var a=e.originalEvent.dataTransfer.files;wcpa_manageUploadFile($(this),a)})),$(document).on("click",".wcpa-upload-area .wcpa_remove_image",(function(e){e.preventDefault(),e.stopPropagation();var a=!1;if($(this).parents(".wcpa_drag_drop").find("input.wcpa_multiple").length>0&&(a=!0),a){var t=$(this).parent().data("position"),i=Number(t),r=$(this).parents(".wcpa_drag_drop").find("input.wcpa_drag_file_input").val(),n=r?JSON.parse(r):[];n[i-1]=null,$(this).parents(".wcpa_drag_drop").find("input.wcpa_drag_file_input").val(JSON.stringify(n)).trigger("change")}else $(this).parents(".wcpa_drag_drop").find("input.wcpa_drag_file_input").val("").trigger("change");$drop_wrap=$(this).parents(".wcpa-upload-area"),$(this).parent().remove(),0==$drop_wrap.find(".thumbnail").length&&($drop_wrap.find(".upload-area-title").show(),$drop_wrap.find(".upload-area-title-thumb-style").hide(),$drop_wrap.find(".upload-area-subtitle").show(),$drop_wrap.find(".wcpa_drop_text").hide()),iterate($drop_wrap.parents(".wcpa_form_outer"))}))}function wcpa_manageUploadFile(e,a){multiple=e.parent().find("input.wcpa_multiple").length>0;var t=new FormData;a&&$.each(a,((a,i)=>{if(wcpa_validate_form($(e).parents(".wcpa_form_outer"),$(e).parents(".wcpa_form_item"),i)){t.append("wcpa_file",i),t.append("wcpa_drag_drop","true");var r=e.parent().data("details");t.append("wcpa_file_details",JSON.stringify(r)),t.append("action","wcpa_ajax_upload"),wcpa_uploadFile(t,e.parent(),multiple)}}))}function wcpa_uploadFile(e,a,t=!1){var i=0,r=!1;wcpa_drag_upload_flag&&!t||(r=!0),r&&$.ajax({type:"POST",url:wcpa_global_vars.ajax_url,xhr:function(){var e=$.ajaxSettings.xhr();return i=a.find("div.thumbnail:first").data("position"),e.upload&&e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);a.find("#thumbnail_"+i+" .wcpa_wcpa_file_upload_progress_active").css("width",t+"%")}}),!1),e},beforeSend:function(){wcpa_addThumbnailSkeleton(a,t),wcpa_drag_upload_flag=!0,a.parents("form").find("button[name=add-to-cart]").addClass("wcpa_disable_cart");var e=parseInt(a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(e)?e=1:e++,a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",e)},success:function(e){wcpa_drag_upload_flag=!1;var r=parseInt(a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(r)||1===r?(r=0,a.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart")):r--,a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",r),!0===e.status?(wcpa_addThumbnailImage(e,a,i,t),a.find("#thumbnail_"+i+" .wcpa_file_upload_progress").remove()):wcpa_AjaxUploadError(a,i,e.message,t)},error:function(e,r,n){var c=parseInt(a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count"));isNaN(c)||1===c?(c=0,a.parents("form").find("button[name=add-to-cart]").removeClass("wcpa_disable_cart")):c--,a.parents("form").find("button[name=add-to-cart]").data("wcpa-upload-count",c),"abort"!==n&&wcpa_AjaxUploadError(a,i,"",t)},async:!0,data:e,dataType:"json",cache:!1,contentType:!1,processData:!1})}function wcpa_addThumbnailSkeleton(e,a){var t=e.find(".wcpa-upload-area"),i=e.find("div.thumbnail:first").data("position")?e.find("div.thumbnail:first").data("position"):0,r=Number(i),n='<div class="wcpa_file_upload_progress"><div class="wcpa_file_upload_progress_inner">';n+='<div class="wcpa_wcpa_file_upload_progress_bar">',n+='<span class="wcpa_wcpa_file_upload_progress_active"></span></div>',e.hasClass("wcpa_drop_preview")&&(n+="<div class='wcpa_wcpa_file_upload_progress_text'>"+wcpa_global_vars.strings.drag_drop_ajax_file_upload.uploading+"</div>"),n+="</div></div>",a||0===r?(r+=1,t.prepend('<div id="thumbnail_'+r+'" data-position="'+r+'" class="thumbnail"></div>'),t.find("#thumbnail_"+r).append(n)):(t.find("#thumbnail_"+r).html(""),t.find("#thumbnail_"+r).append(n)),e.find(".upload-area-title").hide(),e.find(".upload-area-title-thumb-style").show()}function wcpa_addThumbnailImage(e,a,t,i){var r=e.file.file+"||"+e.file.file_name;if(r){if(i){var n=a.find(".wcpa_drag_file_input").val(),c=n?JSON.parse(n):[];c[t-1]=r,a.find(".wcpa_drag_file_input").val(JSON.stringify(c)).trigger("change")}else a.find(".wcpa_drag_file_input").val(r).trigger("change");var p=Number(t),l=e.file.file_name,s=e.file.url;a.find("#thumbnail_"+p).empty(),a.find("#thumbnail_"+p).attr("data-fileData",r),a.find("#thumbnail_"+p).append('<span class="wcpa_remove_image"></span>');var o=l.split("."),_=o[o.length-1];a.hasClass("wcpa_drop_preview")&&(["jpg","jpeg","png","gif","svg"].indexOf(_.toLowerCase())>-1?a.find("#thumbnail_"+p).append('<img src="'+s+'" alt="'+l+'"/>'):a.find("#thumbnail_"+p).append('<div class="wcpa_img_place_holder">'+_.toUpperCase()+"</div>")),a.find("#thumbnail_"+p).append('<div class="wcpa_file_details_content_title">'+l+"</div>"),a.find(".wcpa-upload-message").html(e.message),iterate(a.parents(".wcpa_form_outer"))}}function wcpa_AjaxUploadError(e,a,t="",i=!1){var r=e.find(".wcpa_drag_file_input").val();if(i){var n=r?JSON.parse(r):[];n[a-1]=null,e.find(".wcpa_drag_file_input").val(JSON.stringify(n)).trigger("change")}else e.find(".wcpa_drag_file_input").val("").trigger("change");var c=Number(a),p=t||wcpa_global_vars.strings.ajax_upload_error;e.find("#thumbnail_"+c).remove(),e.find(".wcpa-upload-message").html(p),0==e.find(".thumbnail").length&&(e.find(".upload-area-title").show(),e.find(".upload-area-title-thumb-style").hide(),e.find(".upload-area-subtitle").show(),e.find(".wcpa_drop_text").hide())}function regExpFromString(e,a){var t=e.replace(/.*\/([gimuy]*)$/,"$1");t===e&&(t="");var i="/"==e.charAt(0)?e.replace(new RegExp("^/(.*?)/"+t+"$"),"$1"):e;try{return""==t&&"/"!==e.charAt(0)&&(t=a),new RegExp(i,t)}catch(e){return null}}function compareRegExpWithString(e="",a=""){return new RegExp("^"+a+"$").test(e)}var total_price=0,total_fee=0,wcpa_price=function(e){return wcpa_number_format(e,wcpa_global_vars.wc_price_decimals,wcpa_global_vars.wc_decimal_sep,wcpa_global_vars.wc_thousand_sep)};function wcpa_number_format(e,a,t,i){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var r=isFinite(+e)?+e:0,n=isFinite(+a)?Math.abs(a):0,c=void 0===i?",":i,p=void 0===t?".":t,l="";return l=(n?function(e,a){var t=Math.pow(10,a);return""+Math.round(e*t)/t}(r,n):""+Math.round(r)).split("."),l[0].length>3&&(l[0]=l[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,c)),(l[1]||"").length<n&&(l[1]=l[1]||"",l[1]+=new Array(n-l[1].length+1).join("0")),l.join(p)}function exc_Label(ele,$form_outer){if(void 0===$form_outer&&($form_outer=!1),"string"==typeof ele)var $element=$("#"+ele,$form_outer);else var $element=ele;var product_data=$form_outer.data("product");if(0==$element.length)return!1;var quantity=parseInt($form_outer.parents("form").find("input[name=quantity]").val());if($element.find(".wcpa_paragraph_block").length){var $label=$element.find(".wcpa_paragraph_block").data("label");if(void 0===$label||void 0===$label.label)return!1;if($label.label.match(/\#\=(.+?)\=\#/)){var matches=$label.label.match(/\#\=(.+?)\=\#/g),out=$label.label;for(var i in matches){var mat=matches[i].match(/\#\=(.+?)\=\#/);if(mat[1]){var formula=calculate_price("custom",1,mat[1],quantity,product_data,$element,!1,!0);if(""===formula||"0"===formula)out=out.replace(mat[0],"");else try{var res=eval(formula);isNaN(res)||res%1==0||(res=wcpa_price(res)),out=out.replace(mat[0],res)}catch(e){out=out.replace(mat[0],formula)}}}$element.find(".wcpa_paragraph_block").html(out)}}if($element.find(".wcpa_statictext_block").length){var $static_value=$element.find(".wcpa_statictext_block").data("value");if(void 0===$static_value||void 0===$static_value.value)return!1;if($static_value.value.match(/\#\=(.+?)\=\#/)){var matches=$static_value.value.match(/\#\=(.+?)\=\#/g),out=$static_value.value;for(var i in matches){var mat=matches[i].match(/\#\=(.+?)\=\#/);if(mat[1]){var formula=calculate_price("custom",1,mat[1],quantity,product_data,$element,!1,!0);if(""===formula||"0"===formula)out=out.replace(mat[0],"");else try{var res=eval(formula);isNaN(res)||res%1==0||(res=wcpa_price(res)),out=out.replace(mat[0],res)}catch(e){out=out.replace(mat[0],formula)}}}$element.find(".wcpa_statictext_block").html(out)}}}function exc_relations(ele_id,$form_outer){void 0===$form_outer&&($form_outer=!1);var $element=$("#"+ele_id,$form_outer),product_data=$form_outer.data("product");if(0==$element.length)return!1;var $relation=$element.data("rules");if(!$relation)return!1;var $rules=$relation.rules;$evel_str="",$rules.forEach((function(e){$evel_str+="(",e.rules.forEach((function(e){$evel_str+="(",eval_relation(e.rules,$element,product_data,$form_outer)?$evel_str+=" true ":$evel_str+=" false ",$evel_str+=") "+(!1!==e.operator?e.operator:"")+" "})),e.length>0&&($evel_str=$evel_str.match(/\(.*\)/g)[0]+" "),$evel_str+=") "+(!1!==e.operator?e.operator:"")+" "})),$rules.length>0&&($evel_str=$evel_str.match(/\(.*\)/g)[0]);var result=!1;try{result=eval($evel_str.replace(/or/gi,"||").replace(/and/gi,"&&"))}catch(e){return!1}if(result)if("show"==$relation.action){if(enable_fields($element),$element.is(":visible"))return!0;$element.show(0,(function(){$element.trigger("element_cl_updated")})).addClass("wcpa_cl_visible")}else{if(disable_fields($element),$element.removeClass("wcpa_cl_visible"),!$element.is(":visible"))return!0;$element.hide(0,(function(){$element.trigger("element_cl_updated")}))}else if("show"==$relation.action){if(disable_fields($element),$element.removeClass("wcpa_cl_visible"),!$element.is(":visible"))return!0;$element.hide(0,(function(){$element.trigger("element_cl_updated")}))}else{if(enable_fields($element),$element.is(":visible"))return!0;$element.show(0,(function(){$element.trigger("element_cl_updated")})).addClass("wcpa_cl_visible")}var related=$element.data("related");null!=related&&related.forEach((function(e){exc_relations(e,$form_outer)})),$form_outer.trigger("wcpa.cl_updated"),setTimeout((function(){iterate($element.parents(".wcpa_form_outer"))}),0)}function disable_fields(e){e.find("select,input,file,textarea").attr("disabled","disabled")}function enable_fields(e){e.find("select,input,file,textarea").removeAttr("disabled"),e.is(".wcpa_type_color")&&$(".wcpa_colorpicker",e).spectrum({preferredFormat:"hex",showInput:!0,allowEmpty:!0})}function eval_relation(e,a,t,i){if("quantity"===e.cl_field)var r=a.parents("form").find("input[name=quantity]");else if("attribute"===e.cl_field||"custom_attribute"===e.cl_field){var n=void 0!==t.product_attributes[e.cl_relation]?t.product_attributes[e.cl_relation].value:[];if(t.is_variable)if($dropdown=a.parents("form.variations_form").find(".variations select[name='attribute_"+e.cl_relation+"']"),$dropdown&&$dropdown.length>0)r=(r=a.parents("form.variations_form").find(".variations select[name='attribute_"+e.cl_relation+"']").val())?[r]:[];else r=n;else r=n}else if("stock_status"===e.cl_field){(r=new Array).push(t.stock_status)}else if("stock_quantity"===e.cl_field){(r=new Array).push(t.stock_quantity)}else if("custom_field"===e.cl_field){(r=new Array).push(t.product_cfs)}else if("product_ids"===e.cl_field){(r=new Array).push(t.product_id)}else r=$("#"+e.cl_field,i);if(!r.length)return!1;if("0"===e.cl_relation)return!1;var c=Array();if($.inArray(e.cl_field,["stock_status","stock_quantity","custom_field","product_ids","attribute","custom_attribute"])<0&&(r.is(":visible")||$.inArray(r.data("type"),["hidden"])>=0||"quantity"==e.cl_field))if($.inArray(r.data("type"),["text","color","hidden"])>=0)r.find("input").val()&&c.push(r.find("input").val().toLowerCase().trim());else if($.inArray(r.data("type"),["file"])>=0){var p=e.cl_field;if(p=p.replace("wcpa-","#"),r.find("input[type=hidden]").length){var l="",s=r.find("input[type=hidden]").val();s?$(p).hasClass("wcpa_multiple")?s&&(files=JSON.parse(s),files&&$.each(files,((e,a)=>{a&&2===a.split("||").length&&c.push(a.split("||")[1].toLowerCase())}))):2===s.split("||").length&&c.push(s.split("||")[1].toLowerCase()):r.find(".wcpa_drag_drop").length<=0&&r.find(p)[0].files.length&&(l=r.find(p)[0].files,$.each(l,((e,a)=>{c.push(a.name.toLowerCase())})))}else r.find(p)[0].files.length&&(l=r.find(p)[0].files,$.each(l,((e,a)=>{c.push(a.name.toLowerCase())})))}else if($.inArray(r.data("type"),["number"])>=0)r.find("input").val()&&c.push(parseFloat(r.find("input").val().toLowerCase().trim()));else if("quantity"===e.cl_field)r.val()&&c.push(parseFloat(r.val().toLowerCase().trim()));else if($.inArray(r.data("type"),["textarea"])>=0)r.find("textarea").val()&&c.push(r.find("textarea").val().toLowerCase().trim());else if($.inArray(r.data("type"),["checkbox-group","radio-group"])>=0)c=r.find("input:checked").map((function(){return $(this).hasClass("wcpa_other")?$.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0?$(this).val().replace("WCPAOTH ","").toLowerCase():"other":$(this).val().toLowerCase()})).get();else if($.inArray(r.data("type"),["select"])>=0)r.find("select").val()&&r.find("select").val().constructor===Array?c=r.find("select").val().map((function(e){return e.toLowerCase()})):r.find("select").val()&&c.push(r.find("select").val().toLowerCase());else if($.inArray(r.data("type"),["date","datetime-local"])>=0){if(r.find("input").val())if($.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0)c.push(r.find("input").val().toLowerCase());else"function"==typeof(o=wcpa_get_date_obj(r.find("input").val(),"wp")).getTime&&c.push(o.getTime())}else if($.inArray(r.data("type"),["time"])>=0){if(r.find("input").val())if($.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0)c.push(r.find("input").val().toLowerCase());else{var o=new Date("1/1/2018 "+r.find("input").val());c.push(o.getTime())}}else $.inArray(r.data("type"),["image-group","color-group"])>=0?c=r.find("input:checked").map((function(){return $(this).hasClass("wcpa_other")?$.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0?$(this).val().replace("WCPAOTH ","").toLowerCase():"other":$(this).val().toLowerCase()})).get():$.inArray(r.data("type"),["productGroup"])>=0&&(c=r.find("input:checked").map((function(){return $(this).val()})).get());var _=!1;if("attribute"===e.cl_field||"custom_attribute"===e.cl_field)return!(!r||!r.length)&&(c=r.map((function(e){return e.toLowerCase()})),_=(_=e.cl_val.value?e.cl_val.value:e.cl_val).toLowerCase(),$.inArray(_,c)>=0);if("stock_status"===e.cl_field)c.push(t.stock_status);else if("stock_quantity"===e.cl_field)c.push(t.stock_quantity);else if("product_ids"===e.cl_field)c.push(t.product_id);else if("custom_field"===e.cl_field)return void 0!==t.product_cfs["wcpa_pcf_"+e.cl_relation]&&(c.push(t.product_cfs["wcpa_pcf_"+e.cl_relation].toLowerCase()),_=e.cl_val.value?e.cl_val.value:e.cl_val,$.inArray(_,c)>=0);if(0==c.length)switch(e.cl_relation){case"is_empty":return 0===c.length||""===c[0]||null===c[0];case"is_not_empty":return 0!==c.length&&""!==c[0]&&null!==c[0];default:return!1}if(e.cl_val&&"stock_status"===e.cl_field)_=e.cl_val.value?e.cl_val.value:e.cl_val;else if(e.cl_val&&"product_ids"===e.cl_field)_=(_=(e.cl_val.value?e.cl_val.value:e.cl_val).split(/[ ,]+/)).map((function(e){return parseInt(e,10)}));else if(e.cl_val&&"quantity"===e.cl_field||"stock_quantity"===e.cl_field)_=parseInt(e.cl_val.value?e.cl_val.value:e.cl_val);else if(e.cl_val&&"image-group"==r.data("type"))_=(e.cl_val.i?e.cl_val.i:e.cl_val).toLowerCase();else if(!e.cl_val||"date"!=r.data("type")&&"datetime-local"!=r.data("type"))if(e.cl_val&&"time"==r.data("type")){if($.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0)_=e.cl_val.toLowerCase();else _=new Date("1/1/2018 "+e.cl_val).getTime()}else e.cl_val&&"number"==r.data("type")?_=parseFloat(e.cl_val.value?e.cl_val.value:e.cl_val):e.cl_val&&(_=(e.cl_val.value?e.cl_val.value:e.cl_val).toLowerCase());else{if($.inArray(e.cl_relation,["contains","not_contains","starts_with","ends_with"])>=0)_=e.cl_val.toLowerCase();else _=wcpa_get_date_obj(e.cl_val).getTime()}switch(e.cl_relation){case"is":case"date_is":case"time_is":return $.inArray(_,c)>=0;case"is_not":return!($.inArray(_,c)>=0);case"is_in":return!!Array.isArray(_)&&_.filter((function(e){return $.inArray(e,c)>=0})).length>0;case"is_not_in":return!!Array.isArray(_)&&!(_.filter((function(e){return $.inArray(e,c)>=0})).length>0);case"is_empty":return 0===c.length||""===c[0]||null===c[0];case"is_not_empty":return 0!==c.length&&""!==c[0]&&null!==c[0];case"is_greater":for(var d=0;d<c.length;d++)if(parseFloat(c[d])>parseFloat(_))return!0;return!1;case"is_lessthan":for(d=0;d<c.length;d++)if(parseFloat(c[d])>=parseFloat(_))return!1;return!0;case"is_greater_or_eqaul":for(d=0;d<c.length;d++)if(parseFloat(c[d])>=parseFloat(_))return!0;return!1;case"is_lessthan_or_eqal":for(d=0;d<c.length;d++)if(parseFloat(c[d])>parseFloat(_))return!1;return!0;case"contains":for(d=0;d<c.length;d++)if(-1!==c[d].indexOf(_))return!0;return!1;case"not_contains":for(d=0;d<c.length;d++)if(-1!==c[d].indexOf(_))return!1;return!0;case"starts_with":for(d=0;d<c.length;d++)if(c[d].startsWith(_))return!0;return!1;case"ends_with":for(d=0;d<c.length;d++)if(c[d].endsWith(_))return!0;return!1;case"date_is_before":case"time_is_before":for(d=0;d<c.length;d++)if(parseFloat(c[d])>=parseFloat(_))return!1;return!0;case"date_is_after":case"time_is_after":for(d=0;d<c.length;d++)if(parseFloat(c[d])>parseFloat(_))return!0;return!1}}function iterate(e,a){if(void 0===a&&(a=!0),a&&$(".wcpa_form_item",e).data("wcpa_price",!1),e.data("wcpa_deps_counter",0),wcpa_may_update_quantity(e),total_price=0,total_fee=0,$(".wcpa_has_price",e).each((function(a,t){if(!wcpa_check_form_visibility($(this),$(this).parents(".wcpa_form_item")))return!0;$(this).is("select")?$(this).find("option").each((function(){wcpa_update_price($(this),e.data("product"))})):wcpa_update_price($(this),e.data("product"))})),e.data("wcpa_deps_counter")>0)iterate(e,!1);else{if($(".wcpa_has_price",e).length){var t=+e.data("product").wc_product_price,i=+e.data("product").wc_product_regular_price,r=+e.data("product").con_unit,n=e.data("rules"),c=parseInt(e.parents("form").find("input[name=quantity]").val());if(c||(c=1),n&&!0===n.pric_overide_base_price)var p=Math.max(t*r,total_price);else if(n&&!0===n.pric_overide_base_price_if_gt_zero&&total_price>0)p=total_price;else if(n&&!0===n.pric_overide_base_price_fully)p=total_price;else p=t*r+total_price;wcpa_global_vars.change_price_as_quantity?(e.parent().find(".wcpa_price_summary").find(".wcpa_options_total .price_value").text(wcpa_price((total_price-total_fee)*c+total_fee)),e.parent().find(".wcpa_price_summary").find(".wcpa_product_total .price_value").text(wcpa_price(t*c*r)),i!=t&&e.parent().find(".wcpa_price_summary").find(".wcpa_product_total .wcpa_price_strike").text(wcpa_price(i*c*r)),e.parent().find(".wcpa_price_summary").find(".wcpa_total .price_value").text(wcpa_price((p-total_fee)*c+total_fee))):(e.parent().find(".wcpa_price_summary").find(".wcpa_options_total .price_value").text(wcpa_price(total_price)),e.parent().find(".wcpa_price_summary").find(".wcpa_product_total .price_value").text(wcpa_price(t*r)),e.parent().find(".wcpa_price_summary").find(".wcpa_product_total .wcpa_price_strike").text(wcpa_price(t*r)),i!=t&&e.parent().find(".wcpa_price_summary").find(".wcpa_product_total .wcpa_price_strike").text(wcpa_price(i*r)),e.parent().find(".wcpa_price_summary").find(".wcpa_total .price_value").text(wcpa_price(p<0?0:p))),e.data("wcpa",{fee:total_fee,price:{options:total_price,product:t,total:p}}),e.trigger("wcpa.price_updated")}if(wcpa_may_update_quantity(e),$(".wcpa_has_label_formula, .wcpa_has_value_formula",e).each((function(a,t){if(!($(this).parent().is(":visible")||$(this).parents(".wcpa_form_item").is(".wcpa_visible")||$(this).parents(".wcpa_form_item").is(".wcpa_visible_parent")))return!0;exc_Label($(this).parents(".wcpa_form_item"),e)})),$(".wcpa_update_product_image",e).length){var l=!1;$($(".wcpa_update_product_image",e).get().reverse()).each((function(){if($(this).is("select")){if($ele=$(this).find("option:selected"),!$ele)return}else{if(!$(this).is(":checked"))return;$ele=$(this)}if($(this).parents(".wcpa_form_item").is(":visible")||$(this).parents(".wcpa_form_item").hasClass("wcpa_cl_visible")){var a=$ele.data("image");if(a&&a.src)return wcpa_product_image_update(e.parents("form"),$ele),l=!0,!1}})),l||wcpa_product_image_update(e.parents("form"),!1)}}}function wcpa_may_update_quantity(e){var a=e.data("rules");if(a.bind_quantity){var t=$("input[name=quantity]",e.parents("form"));if(t.length){t.attr("readonly","readonly");var i=calculate_price("custom",1,a.quantity_bind_formula,1,e,t),r=t.val();i>0?t.val(i):t.val(1),r!=t.val()&&t.trigger("change")}}}function wcpa_update_price(e,a){var t=e.data("price"),i="undefined"!=typeof awdajaxobject?awdajaxobject.priceGroup.data:[];Array.isArray(i)&&i.length>0&&!isNaN(t.value)&&$.each(i,(function(e,a){t.discounted||("fixed"==a.type?t.value-a.value>=0?t.value=t.value-a.value:t.value=0:t.value=t.value-t.value*(a.value/100),t.discounted=!0)}));var r=parseInt(e.parents("form").find("input[name=quantity]").val()),n=0,c=0;if(!t)t=e.find(":selected").data("price");t||(t={type:!1,priceoptions:!1,value:!1,pricingType:!1,taxpu:1,con_unit:1,is_show_price:!1});var p=e.val().trim();if($.inArray(t.type,["radio-group","checkbox-group","image-group","color-group","productGroup"])>=0&&!e.is(":checked")&&(p=!1),$.inArray(t.type,["select"])>=0&&!e.is(":selected")&&(p=!1),e.hasClass("wcpa_other")&&$.inArray(t.type,["radio-group","checkbox-group","image-group","color-group"])>=0&&e.is(":checked")&&(p=e.nextAll(".wcpa_other_val").val().trim()),$.inArray(t.type,["paragraph","header","statictext"])>=0&&(p=1),$.inArray(t.type,["file"])>=0&&(e.parents(".wcpa_form_item").find(".wcpa_file_hidden").length&&""==p&&""!==e.parents(".wcpa_form_item").find(".wcpa_file_hidden").val()&&(p=e.parents(".wcpa_form_item").find(".wcpa_file_hidden").val().split("||")[1]),e.parents(".wcpa_form_item").find(".wcpa_drag_file_input").length)){var l=e.parents(".wcpa_form_item").find(".wcpa_drag_file_input").val();if(""!==l)if(e.parents(".wcpa_form_item").find(".wcpa_drag_file_input.wcpa_multiple").length){var s=JSON.parse(l),o="";s&&$.each(s,((e,a)=>{a&&(o+=a.split("||")[1])})),p=""!=o&&o}else p=l.split("||")[1]}n=calculate_price(t.pricingType,p,t.value,r,a,e,t),"custom"!=t.pricingType&&"percentage"!=t.pricingType||t.taxpu&&(n*=t.taxpu),t.con_unit&&(n*=t.con_unit),void 0!==t.is_show_price&&0!=t.is_show_price||(total_price+=n);var _=1;void 0!==wcpa_global_vars.show_field_price_x_quantity&&wcpa_global_vars.show_field_price_x_quantity&&(_=r),void 0!==t.is_fee&&!0===t.is_fee&&(total_fee+=n,_=1),e.data("elem_price",n),e.is("option")?(e.parent().find(":checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):"checkbox-group"==t.type?(e.parents(".checkbox-group").find("input:checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):"radio-group"==t.type?(e.parents(".radio-group ").find("input:checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):"image-group"==t.type?(e.parents(".image-group ").find("input:checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):"productGroup"==t.type?(e.parents(".wcpa_productGroup").find("input:checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):"color-group"==t.type?(e.parents(".color-group ").find("input:checked").each((function(){c+=$(this).data("elem_price")?$(this).data("elem_price"):0})),e.parents(".wcpa_form_item").data("wcpa_price",c/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(c*_))):e.parents(".wcpa_form_item").data("wcpa_price",n/(t.taxpu*t.con_unit)).find(".price_value").text(wcpa_price(n*_)),e.parents(".wcpa_form_item").trigger("wcpa.item_price_updated")}function calculate_price(pricingType,value,price,quantity,$product_data,$ele,element_data,isLabel){if(void 0===element_data)var element_data={};if(void 0===isLabel)var isLabel=!1;"custom"!==pricingType&&(null!==price&&!1!==price&&"string"==typeof price&&(price=parseFloat(price.replace(wcpa_global_vars.wc_decimal_sep,"."))),isNaN(price)&&(price=0));var elem_price=0;switch(pricingType){case"fixed":if(value)if($product_qty_ele=$ele.parents(".wcpa_productGroup_item").find("input[type=number]"),$product_qty_ele.length){var qty=parseInt($product_qty_ele.val());qty=qty||0===qty?qty:0,elem_price=+price*qty}else elem_price=+price;else elem_price=0;break;case"per_car":var value_filtered=value;if(void 0!==element_data.excl_chars_frm_length&&element_data.excl_chars_frm_length.length>0)if(void 0!==element_data.excl_chars_frm_length_is_regex&&element_data.excl_chars_frm_length_is_regex){var exclude_chars=element_data.excl_chars_frm_length,re=regExpFromString(exclude_chars,"gi");value_filtered=value_filtered.replace(re,"")}else{var exclude_chars=element_data.excl_chars_frm_length.replace(/\\s/g," ");exclude_chars=exclude_chars.split("").map((function(e){if(" "==e){var a=new RegExp("\\s","g");value_filtered=value_filtered.replace(a,"")}else if("."==e)value_filtered=value_filtered.replace(/\./,"");else{a=new RegExp(e,"g");value_filtered=value_filtered.replace(a,"")}return e}))}elem_price=value_filtered.length*price;break;case"multiply":elem_price=value?+price*(isNaN(value)?1:value):0,elem_price<0&&(elem_price=0);break;case"custom":if(!1!==value&&""!==value&&null!==value){if($ele_outer=$ele.parents(".wcpa_form_item"),"function"==typeof moment)var today={seconds:moment().unix()};else var today={seconds:wcpa_global_vars.today.seconds};if(","==wcpa_global_vars.wc_decimal_sep&&"string"==typeof value){var _val=value.match(/\d*\,?\d*$/);_val&&_val[0]&&(value=value.replace(_val[0],_val[0].replace(",",".")))}var formula=price.replace(/{this.value}/g,value).replace(/{value}/g,value).replace(/{quantity}/g,quantity).replace(/{this.value.length}/g,value.length).replace(/{value.length}/g,value.length).replace(/{product_price}/g,$product_data.wc_product_price).replace(/{days}/g,date_data_from_field("days",$ele_outer)).replace(/{seconds}/g,date_data_from_field("seconds",$ele_outer)).replace(/{timestamp}/g,date_data_from_field("timestamp",$ele_outer)).replace(/{today.days}/g,wcpa_global_vars.today.days).replace(/{today.seconds}/g,today.seconds).replace(/{this.option_price}/g,element_data.option_price?element_data.option_price:0).replace(/{option_price}/g,element_data.option_price?element_data.option_price:0).replace(/{this.count}/g,get_data_from_field("count",$ele)).replace(/{count}/g,get_data_from_field("count",$ele));if(formula.match(/\{(\s)*?wcpa_pcf_([^}]*)}/)){var cf_matches=formula.match(/\{(\s)*?wcpa_pcf_([^}]*)}/g);for(var i in cf_matches){var mat=cf_matches[i].match(/\{(\s)*?([^}]*)}/);if(void 0!==mat[2]&&"string"==typeof mat[2]&&void 0!==$product_data.product_cfs[mat[2].trim()]){var myReg=new RegExp(mat[0]);formula=formula.replace(myReg,$product_data.product_cfs[mat[2].trim()])}else{var myReg=new RegExp(mat[0]);formula=formula.replace(myReg,0)}}}if(formula.match(/\{(\s)*?field\.([^}]*)}/)){var matches=formula.match(/\{(\s)*?field\.([^}]*)}/g);for(var i in matches){var mat=matches[i].match(/\{(\s)*?field\.([^}]*)}/);if(void 0!==mat[2]&&"string"==typeof mat[2]){var ele=mat[2].split(".");if(ele.length>1&&$.inArray(ele[1],["value","price","count","selected","days","seconds","timestamp"])>=0){var $ele=$("#"+ele[0]);if($ele.length){var val=0;if($ele.is(":visible")||"hidden"==$ele.data("type"))switch(ele[1]){case"price":if($ele.find(".wcpa_has_price").length){if(void 0===$ele.data("wcpa_price")||!1===$ele.data("wcpa_price")){elem_price=0;var wcpa_deps_counter=$ele.parents(".wcpa_form_outer").data("wcpa_deps_counter");return wcpa_deps_counter=void 0===wcpa_deps_counter?0:wcpa_deps_counter,wcpa_deps_counter+=1,$ele.parents(".wcpa_form_outer").data("wcpa_deps_counter",wcpa_deps_counter),elem_price}val=$ele.data("wcpa_price")}break;case"value":switch($ele.data("type")){case"select":val=$ele.find("select").val()?$ele.find("select").val():0;break;case"textarea":val=$ele.find("textarea").val()?$ele.find("textarea").val():0;break;case"productGroup":val=0;break;case"checkbox-group":case"radio-group":case"color-group":case"image-group":val=0,$ele.find("input:checked").length?1==$ele.find("input:checked").length?isNaN($ele.find("input:checked").val())?val=$ele.find("input:checked").val():val+=parseFloat($ele.find("input:checked").val()):$ele.find("input:checked").each((function(e){if(isNaN($(this).val())){if(0==e)return val=$(this).val(),!1}else val+=parseFloat($(this).val())})):val=0;break;default:val=$ele.find("input").val()?$ele.find("input").val():0}if(void 0!==ele[2]&&"length"===ele[2])val=val.length;break;case"count":switch($ele.data("type")){case"select":val=$ele.find("select").val()?1:0;break;case"textarea":val=$ele.find("textarea").val()?1:0;break;case"checkbox-group":case"radio-group":case"color-group":case"image-group":val=0,val=$ele.find("input:checked").length?1==$ele.find("input:checked").length?1:$ele.find("input:checked").length:0;break;case"productGroup":val=0;var inputType="radio";$ele.find(".wcpa_multiselect").length&&(inputType="checkbox"),$checked=$ele.find("input[type="+inputType+"]:checked"),$checked.length&&$.each($checked,((e,a)=>{var t=parseInt($(a).siblings("input[type=number]").val());t&&(val+=t)}));break;case"file":if($ele.find("input[type=hidden]").length){var inputSelector=ele[0];val=get_data_from_field("count",$(inputSelector.replace("wcpa-","#")))}else val=get_data_from_field("count",$ele.find("input[type=file]"));break;default:val=$ele.find("input").val()?1:0}break;case"selected":switch($ele.data("type")){case"select":val=$ele.find("select").val()?1:0;break;case"textarea":val=$ele.find("textarea").val()?1:0;break;case"checkbox-group":case"radio-group":case"color-group":case"image-group":val=0,val=$ele.find("input:checked").length?1==$ele.find("input:checked").length?1:$ele.find("input:checked").length:0;break;case"productGroup":val=0;var inputType="radio";$ele.find(".wcpa_multiselect").length&&(inputType="checkbox"),val=$ele.find("input[type="+inputType+"]:checked").length;break;case"file":if($ele.find("input[type=hidden]").length){var inputSelector=ele[0];val=get_data_from_field("selected_count",$(inputSelector.replace("wcpa-","#")))}else val=get_data_from_field("selected_count",$ele.find("input[type=file]"));break;default:val=$ele.find("input").val()?1:0}break;case"days":case"seconds":case"timestamp":switch($ele.data("type")){case"date":case"datetime-local":val=date_data_from_field(ele[1],$ele);break;default:val=0}}}else var val=0;var myReg=new RegExp(mat[0]);formula=isNaN(val)&&!isLabel?formula.replace(myReg,"'"+val+"'"):formula.replace(myReg,val)}}}}if(isLabel)return formula;try{if($product_qty_ele=$ele.parents(".wcpa_productGroup_item").find("input[type=number]"),$product_qty_ele.length){var qty=parseInt($product_qty_ele.val());qty=qty||0===qty?qty:0,elem_price=eval(formula)*qty}else elem_price=eval(formula)}catch(e){elem_price=0}}else{if(isLabel)return"";elem_price=0}break;case"percentage":if(value){var $item_parent=$ele.parents(".wcpa_form_item"),item_type=$item_parent.data("type");if(item_type&&"productGroup"===item_type)if($product_qty_ele=$ele.parents(".wcpa_productGroup_item").find("input[type=number]"),$product_qty_ele.length){var qty=parseInt($product_qty_ele.val());qty=qty||0===qty?qty:0,elem_price=parseFloat(element_data.option_price)*price*qty/100}else elem_price=parseFloat(element_data.option_price)*price/100;else elem_price=price*$product_data.wc_product_price/100}else elem_price=0}return elem_price}function wcpa_get_date_obj(e,a){return a=void 0!==a&&a,"function"==typeof moment?"wp"==a?moment(e,wcpa_global_vars.date_format_js+" "+wcpa_global_vars.time_format_js).toDate():!1!==a?moment(e,a).toDate():moment(e).toDate():new Date(e)}function date_data_from_field(e,a){var t=0;switch(a.data("type")){case"date":case"datetime-local":case"time":if("days"==e)t="function"!=typeof(i=wcpa_get_date_obj(a.find("input").val(),"wp")).getTime||isNaN(i.getTime())?0:(i.getTime()-new Date("1970/01/01").getTime())/864e5;else if("timestamp"==e||"seconds"==e){var i;t="function"!=typeof(i=wcpa_get_date_obj(a.find("input").val(),"wp")).getTime||isNaN(i.getTime())?0:(i.getTime()-new Date("1970/01/01").getTime())/1e3}break;default:t=0}return t}function get_data_from_field(e,a){switch($ele_outer=a.parents(".wcpa_form_item"),val=0,$ele_outer.data("type")){case"select":"count"==e&&(val=$ele_outer.find("select").val()?1:0);break;case"textarea":"count"==e&&(val=a.val()?1:0);break;case"file":if("count"==e||"selected"==e)if($ele_outer.find("input[type=hidden]").length){var t="",i=$ele_outer.find("input[type=hidden]").val(),r=!1;if(i?(t=i,r=!0):a[0].files?val=a[0].files.length?a[0].files.length:0:a.val()&&(t=a.val(),r=!0),r)if(a.hasClass("wcpa_multiple")){if(t&&(files=JSON.parse(t),files)){var n=0;$.each(files,((e,a)=>{a&&n++})),val=n}}else val=1}else a[0].files&&(val=a[0].files.length?a[0].files.length:0);break;case"checkbox-group":case"radio-group":case"color-group":case"image-group":case"productGroup":"count"==e&&(val=0,1==a.prop("checked")?val=1:val=0);break;default:"count"==e&&(val=$ele_outer.find("input").val()?1:0)}return val}function preview_image(){jQuery(".wcpa_type_image-group .wcpa_image .wcpa_img_mag").not(".wcpa_even_binded").on("click",(function(e){var a=$(this).parents(".wcpa_image").find("label").text(),t=a||"";jQuery("body").append("<div id='wcpa_img_popup_outer'><div class='wcpa_img_popup'><img src='"+$(this).attr("data-src")+"' alt='Image preview' /><span>"+t+"</span></div></div>"),jQuery("#wcpa_img_popup_outer").fadeIn("fast").on("click",(function(){$(this).fadeOut("fast").remove()}))})).addClass("wcpa_even_binded"),jQuery(".wcpa_type_productGroup .wcpa_productGroup_option_img .wcpa_img_mag").not(".wcpa_even_binded").on("click",(function(e){e.preventDefault(),e.stopPropagation();var a=$(this).data("title"),t=a||"";jQuery("body").append("<div id='wcpa_img_popup_outer'><div class='wcpa_img_popup'><img src='"+$(this).attr("data-src")+"' alt='Image preview' /><span>"+t+"</span></div></div>"),jQuery("#wcpa_img_popup_outer").fadeIn("fast").on("click",(function(){$(this).fadeOut("fast").remove()}))})).addClass("wcpa_even_binded"),jQuery(".wcpa_img_preview .wcpa_image img,.wcpa_cart_img_preview img,.wcpa_product_img_preview img").not(".wcpa_even_binded").hover((function(e){var a=!0;if($(this).parents(".wcpa_form_item").find(".wcpa_product_img_preview_disable_mobile").length&&$(window).width()<=480&&(a=!1),a){var t=$(this).parent(".wcpa_image").find("label").text(),i=t||"";jQuery("body").append("<div id='wcpa_img_preview'><img src='"+$(this).data("src")+"' alt='Image preview' />"+i+"</div>"),jQuery("#wcpa_img_preview").css("top",e.pageY-10+"px").css("left",e.pageX-30-jQuery("#wcpa_img_preview").width()+"px").fadeIn("fast")}}),(function(){jQuery("#wcpa_img_preview").remove()})).addClass("wcpa_even_binded"),jQuery(".wcpa_img_preview .wcpa_image img,.wcpa_cart_img_preview img").not(".wcpa_even_binded").mousemove((function(e){var a=!0;if($(this).parents(".wcpa_form_item").find(".wcpa_product_img_preview_disable_mobile").length&&$(window).width()<=480&&(a=!1),a){var t=$(window).scrollTop()+$(window).height(),i=e.pageY+jQuery("#wcpa_img_preview").height(),r=e.pageY-jQuery("#wcpa_img_preview").height();if($(window).scrollTop()-r<i-t)var n=e.pageY-10-jQuery("#wcpa_img_preview").height();else n=e.pageY+10;if(e.pageX-jQuery("#wcpa_img_preview").width()<0&&$(window).width()-(e.pageX+jQuery("#wcpa_img_preview").width())>e.pageX-jQuery("#wcpa_img_preview").width()){var c=e.pageX+30;jQuery("#wcpa_img_preview").css("top",n+"px").css("right","auto").css("left",c+"px")}else{var p=$(window).width()-(e.pageX+30);jQuery("#wcpa_img_preview").css("top",n+"px").css("left","auto").css("right",p+"px")}}})).addClass("wcpa_even_binded")}function wcpa_validate_form(e,a="",t=!1){var i=!0;if(a){var r=wcpa_validate_field($(a),t);""!=r.element&&(r.success?($(a).find(".wcpa_error_msg").remove(),wcpa_global_vars.show_validation_box&&$(".wcpa_validation_summary ul",e.parents("form")).each(((e,t)=>{$(t).find(`li#wcpa-error-toast-${e}-${a.attr("id")}`).remove()})),r.element&&$(r.element).removeClass("wcpa_validation_error"),r.element&&r.element.removeClass("wcpa_validation_error")):(r.appendAfter.siblings(".wcpa_error_msg").remove(),$error_ele=$('<div class="wcpa_error_msg"><p>'+r.message+"</p></div>").insertAfter(r.appendAfter),r.element.addClass("wcpa_validation_error"),i=!1)),wcpa_validate_charector_count($(a))}else e.find(".wcpa_form_item.wcpa_validate_field").each(((a,r)=>{var n=wcpa_validate_field($(r),t);""!=n.element&&(n.success?($(r).find(".wcpa_error_msg").remove(),wcpa_global_vars.show_validation_box&&$(".wcpa_validation_summary ul",e).find(`li#wcpa-error-toast-${r.id}`).remove(),n.element&&$(n.element).removeClass("wcpa_validation_error")):(n.appendAfter.siblings(".wcpa_error_msg").remove(),$error_ele=$('<div class="wcpa_error_msg"><p>'+n.message+"</p></div>").insertAfter(n.appendAfter),$(n.element).addClass("wcpa_validation_error"),i=!1,wcpa_global_vars.show_validation_box&&$(".wcpa_validation_summary ul",e.parents("form")).length&&$(".wcpa_validation_summary ul",e.parents("form")).each(((e,a)=>{0==$(a).find(`li#wcpa-error-toast-${e}-${r.id}`).length&&$(a).append(`<li id="wcpa-error-toast-${e}-${r.id}">${n.label?`<span class="wcpa_val_title">${n.label} : </span>`:""}\n\t\t\t\t\t\t\t\t\t\t\t\t${n.message}</li>`)})))),wcpa_validate_charector_count($(r))}));return i}function wcpa_validate_field(e,a=!1){var t={success:!0,message:"",appendAfter:"",element:""},i="",r=e.data("type"),n={label:""};switch(r){case"text":if(!wcpa_check_form_visibility(i=e.find("input"),e))break;n=i.data("validation")?i.data("validation"):n;var c=i.val();if(n)if(c){if(n.allowed_chars_enable)for(var p=regExpFromString(n.allowed_chars,"i"),l="",s=0;s<c.length;s++)if(p.test(c.charAt(s)))c.charAt(s);else{l+=c.charAt(s);var o=n.allowed_charsMessage.replace("%s",l);t={success:!1,message:o,appendAfter:i}}n.pattern&&(compareRegExpWithString(c,n.pattern)||(t={success:!1,message:n.patternMessage,appendAfter:i})),n.maxlength&&c.length>n.maxlength&&(t={success:!1,message:n.maxlengthMessage,appendAfter:i}),n.minlength&&c.length<n.minlength&&(t={success:!1,message:n.minlengthMessage,appendAfter:i})}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i});break;case"color":case"time":case"date":case"datetime-local":if(!wcpa_check_form_visibility(i=e.find("input"),e))break;n=i.data("validation")?i.data("validation"):n;c=i.val();n&&n.required&&(!c||c&&-1!==c.indexOf("__"))&&(t={success:!1,message:n.requiredMessage,appendAfter:i});break;case"number":if(!wcpa_check_form_visibility(i=e.find("input"),e))break;n=i.data("validation")?i.data("validation"):n;c=i.val();n&&(c?(n.pattern&&(compareRegExpWithString(c,n.pattern)||(t={success:!1,message:n.patternMessage,appendAfter:i})),n.max&&parseFloat(c)>parseFloat(n.max)&&(t={success:!1,message:n.maxMessage,appendAfter:i}),n.min&&parseFloat(c)<parseFloat(n.min)&&(t={success:!1,message:n.minMessage,appendAfter:i}),n.maxlength&&c.length>parseInt(n.maxlength)&&(t={success:!1,message:n.maxlengthMessage,appendAfter:i}),n.minlength&&c.length<parseInt(n.minlength)&&(t={success:!1,message:n.minlengthMessage,appendAfter:i})):n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i}));break;case"textarea":if(!wcpa_check_form_visibility(i=e.find("textarea"),e))break;n=i.data("validation")?i.data("validation"):n;c=i.val();if(n)if(c){if(n.allowed_chars_enable)for(p=regExpFromString(n.allowed_chars,"i"),l="",s=0;s<c.length;s++)if(p.test(c.charAt(s)))c.charAt(s);else{l+=c.charAt(s);o=allowed_charsMessage.replace("%s",l);t={success:!1,message:o,appendAfter:i}}n.maxlength&&c.length>n.maxlength&&(t={success:!1,message:n.maxlengthMessage,appendAfter:i}),n.minlength&&c.length<n.minlength&&(t={success:!1,message:n.minlengthMessage,appendAfter:i})}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i});break;case"checkbox-group":if(!wcpa_check_form_visibility(i=e.find(".checkbox-group"),e))break;if(n=i.data("validation")?i.data("validation"):n){var _=!1,d=!1;if(i.find("input[type=checkbox]:not(.wcpa_other):checked").length&&(_=!0),i.find("input[type=checkbox]:checked.wcpa_other").length&&i.find("input.wcpa_other_val").val()&&(d=!0),_||d){if(n.min){var u=0;i.find("input[type=checkbox]:checked").each((function(e,a){$(a).hasClass("wcpa_other")?i.find("input.wcpa_other_val").val()&&u++:u++})),u<n.min&&(t={success:!1,message:n.minMessage,appendAfter:i})}if(n.max){u=0;i.find("input[type=checkbox]:checked").each((function(e,a){$(a).hasClass("wcpa_other")?i.find("input.wcpa_other_val").val()&&u++:u++})),u>n.max&&(t={success:!1,message:n.maxMessage,appendAfter:i})}}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i});n.other&&i.find("input[type=checkbox]:checked.wcpa_other").length&&(i.find("input.wcpa_other_val").val()||(t={success:!1,message:n.otherRequiredMessage,appendAfter:i}))}break;case"radio-group":if(!wcpa_check_form_visibility(i=e.find(".radio-group"),e))break;if((n=i.data("validation")?i.data("validation"):n)&&n.required){_=!1;var f=!1;i.find("input[type=radio]:checked").length&&(_=!0),i.find("input[type=radio]:checked.wcpa_other").length&&(i.find("input.wcpa_other_val").val()||(f=!0)),_&&!f||(t={success:!1,message:n.requiredMessage,appendAfter:i})}break;case"file":if(e.find(".wcpa_drag_drop").length){if(!wcpa_check_form_visibility(i=e.find(".wcpa_drag_drop"),e))break;var m=e.find('input[type="hidden"]');n=m.data("validation")?m.data("validation"):n;var w=e.find(".wcpa-upload-message"),h=m.hasClass("wcpa_multiple");if(n){var g=m.val();_=!1;if(g&&h){var v=JSON.parse(g);$.each(v,(function(e,a){a&&(_=!0)}))}else g&&(_=!0);if(A=0!=a&&0!==a.length){var b=a;if(n.maxFileCount)if(n.maxFileCount)if(_&&h)if(g=m.val()){v=JSON.parse(g),u=0;$.each(v,(function(e,a){a&&u++})),u+1>parseInt(n.maxFileCount)&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:w})}if(n.maxFileSize&&b.size>parseInt(n.maxFileSize)&&(t={success:!1,message:n.maxFileSizeMessage,appendAfter:w}),n.minFileSize&&b.size<parseInt(n.minFileSize)&&(t={success:!1,message:n.minFileSizeMessage,appendAfter:w}),n.extensionSupportEnable){var y=n.extensions.split(","),x=!1,k=b.name.split(".").pop().toLowerCase().trim();y.indexOf(k)<=-1&&(x=!0),x&&(t={success:!1,message:n.extensionsInvalidMessage,appendAfter:w})}}else if(_){if(n.maxFileCount)if((g=m.val())&&h){v=JSON.parse(g),u=0;$.each(v,(function(e,a){a&&u++})),u>n.maxFileCount&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:w})}}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:w})}}else if(e.find('input[type="hidden"]').length){if(!wcpa_check_form_visibility(i=e.find(".wcpa_file_outer"),e))break;m=e.find('input[type="hidden"]');var q=e.find('input[type="file"]');n=m.data("validation")?m.data("validation"):n;h=q.hasClass("wcpa_multiple");if(n){g=m.val(),_=!1;if(h&&g){v=JSON.parse(g);$.each(v,(function(e,a){a&&(_=!0)}))}else g&&(_=!0);var A=0!==q.prop("files").length;if(_){if(n.maxFileCount)if((g=m.val())&&h){v=JSON.parse(g),u=0;$.each(v,(function(e,a){a&&u++})),u>parseInt(n.maxFileCount)&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:m})}}else if(A){var C=q.prop("files");if(n.maxFileCount&&C.length>0&&h&&C.length>parseInt(n.maxFileCount)&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:m}),n.maxFileSize&&jQuery.each(C,((e,a)=>!(a.size>parseInt(n.maxFileSize))||(t={success:!1,message:n.maxFileSizeMessage,appendAfter:m},!1))),n.minFileSize&&jQuery.each(C,((e,a)=>!(a.size<parseInt(n.minFileSize))||(t={success:!1,message:n.minFileSizeMessage,appendAfter:m},!1))),n.extensionSupportEnable){y=n.extensions.split(","),x=!1;jQuery.each(C,((e,a)=>{var t=a.name.split(".").pop().toLowerCase().trim();y.indexOf(t)<=-1&&(x=!0)})),x&&(t={success:!1,message:n.extensionsInvalidMessage,appendAfter:m})}}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:m})}}else if(e.find(".wcpa_file_outer").length){if(!wcpa_check_form_visibility(i=e.find(".wcpa_file_outer"),e))break;h=(m=e.find("input")).hasClass("wcpa_multiple");if(n=m.data("validation")?m.data("validation"):n)if(m.val()){if(n.minFileSize)if(g=m.val())if(F=m.prop("files")){var j=!1;$.each(F,(function(e,a){a&&a.size<n.minFileSize&&(j=!0)})),j&&(t={success:!1,message:n.minFileSizeMessage,appendAfter:i})}if(n.maxFileSize)if(g=m.val())if(F=m.prop("files")){j=!1;$.each(F,(function(e,a){a&&a.size>n.maxFileSize&&(j=!0)})),j&&(t={success:!1,message:n.maxFileSizeMessage,appendAfter:i})}if(n.extensionSupportEnable)if(g=m.val()){y=n.extensions.split(",");if(F=m.prop("files")){x=!1;$.each(F,(function(e,a){var t=a.name.split(".").pop().toLowerCase();y.indexOf(t)<=-1&&(x=!0)})),x&&(t={success:!1,message:n.extensionsInvalidMessage,appendAfter:i})}}if(n.maxFileCount)if((g=m.val())&&h)(F=m.prop("files"))&&F.length>n.maxFileCount&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:i})}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i})}else{if(!wcpa_check_form_visibility(i=e.find("input"),e))break;h=i.hasClass("wcpa_multiple");if(n=i.data("validation")?i.data("validation"):n)if(i.val()){if(n.minFileSize)if(g=i.val())if(F=i.prop("files")){j=!1;$.each(F,(function(e,a){a&&a.size<n.minFileSize&&(j=!0)})),j&&(t={success:!1,message:n.minFileSizeMessage,appendAfter:i})}if(n.maxFileSize)if(g=i.val())if(F=i.prop("files")){j=!1;$.each(F,(function(e,a){a&&a.size>n.maxFileSize&&(j=!0)})),j&&(t={success:!1,message:n.maxFileSizeMessage,appendAfter:i})}if(n.extensionSupportEnable)if(g=i.val()){var F;y=n.extensions.split(",");if(F=i.prop("files")){x=!1;$.each(F,(function(e,a){var t=a.name.split(".").pop().toLowerCase();y.indexOf(t)<=-1&&(x=!0)})),x&&(t={success:!1,message:n.extensionsInvalidMessage,appendAfter:i})}}if(n.maxFileCount)if((g=i.val())&&h)(F=i.prop("files"))&&F.length>n.maxFileCount&&(t={success:!1,message:n.maxFileCountMessage,appendAfter:i})}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i})}break;case"select":if(!wcpa_check_form_visibility(i=e.find(".select"),e))break;m=e.find("select");if(n=m.data("validation")?m.data("validation"):n)if(m.attr("required"))(g=m.val()).length||(t={success:!1,message:n.requiredMessage,appendAfter:e.find(".select")});break;case"image-group":case"color-group":if(!wcpa_check_form_visibility(i=e.find("."+r),e))break;if(n=i.data("validation")?i.data("validation"):n){_=!1;var S=!1,M="radio";if(i.hasClass("wcpa_multiselect")&&(M="checkbox"),i.find("input[type="+M+"]:not(.wcpa_other):checked").length&&(_=!0),i.find("input[type="+M+"]:checked.wcpa_other").length&&i.find("input.wcpa_other_val").val()&&(S=!0),_||S){if(i.find("input[type=checkbox]").length){if(n.min){u=0;i.find("input[type=checkbox]:checked").each((function(e,a){$(a).hasClass("wcpa_other")?i.find("input.wcpa_other_val").val()&&u++:u++})),u<n.min&&(t={success:!1,message:n.minMessage,appendAfter:i})}if(n.max){u=0;i.find("input[type=checkbox]:checked").each((function(e,a){$(a).hasClass("wcpa_other")?i.find("input.wcpa_other_val").val()&&u++:u++})),u>n.max&&(t={success:!1,message:n.maxMessage,appendAfter:i})}}}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i});n.other&&i.find("input[type="+M+"]:checked.wcpa_other").length&&(i.find("input.wcpa_other_val").val()||(t={success:!1,message:n.otherRequiredMessage,appendAfter:i}))}break;case"productGroup":if(!wcpa_check_form_visibility(i=e.find(".wcpa_"+r),e))break;n=i.data("validation")?i.data("validation"):n;M="radio";if(i.hasClass("wcpa_multiselect")&&(M="checkbox"),n)if(i.find("input[type="+M+"]:checked").length){if(i.find("input[type=checkbox]").length){if(n.min)(u=i.find("input[type=checkbox]:checked").length)<n.min&&(t={success:!1,message:n.minMessage,appendAfter:i});if(n.max)(u=i.find("input[type=checkbox]:checked").length)>n.max&&(t={success:!1,message:n.maxMessage,appendAfter:i})}if(n.qty&&i.find("input[type="+M+"]:checked").length){$products=i.find("input[type="+M+"]:checked");var N=!1;$.each($products,((e,a)=>{if($(a).siblings("input[type=number]").length){var t=$(a).siblings("input[type=number]").val();(void 0===t||""===t||t<=0||t.indexOf(".")>-1)&&(N=!0)}})),N&&(t={success:!1,message:n.qtyMessage,appendAfter:i})}}else n.required&&(t={success:!1,message:n.requiredMessage,appendAfter:i});break;case"placeselector":if(!wcpa_check_form_visibility(i=e.find("input.wcpa_google_place"),e))break;(n=i.data("validation")?i.data("validation"):n)&&i.attr("required")&&(i.val()||(t={success:!1,message:n.requiredMessage,appendAfter:i}));break;default:t={success:!0,message:"",appendAfter:""}}return t.element=i,t.label=n.label?n.label:"",t}function wcpa_validate_charector_count(e){var a={success:!1,message:""},t="";switch(e.data("type")){case"text":case"number":t=e.find("input");break;case"textarea":t=e.find("textarea");break;default:t=""}if(t){if(!wcpa_check_form_visibility(t,e))return;var i=t.data("validation")?t.data("validation"):i,r=t.val();if(i&&r&&i.maxlength&&i.charleft){var n=i.maxlength-r.length;n>=0&&(a={success:!0,message:i.charleftMessage.replace("%s",n)})}a.success?(e.find(".wcpa_char_left_message").show(),e.find(".wcpa_char_left_message p").text(a.message)):e.find(".wcpa_char_left_message").hide()}}function wcpa_check_form_visibility(e,a){return!!(e.parent().is(":visible")||a.is(".wcpa_visible")||a.is(".wcpa_visible_parent"))}$.wcpaInit=function(){preview_image(),$(".cart_item.wcpa_bind_quantity.wcpa_cart_has_fields .quantity .qty").attr("readonly","readonly"),$(".wcpa_tooltip_icon").not(".wcpa_even_binded").hover((function(){$that=$(this),setTimeout((function(){if($ele=$(".wcpa_tooltip",$that).get(0),"function"==typeof $ele.getBoundingClientRect){var e=$ele.getBoundingClientRect(),a=$that.get(0).getBoundingClientRect();e.x+e.width>$(window).width()&&($(".wcpa_tooltip",$that).css("left","-"+Math.min(e.x-parseInt(($(window).width()-e.width)/2),e.width-20)+"px"),$(".wcpa_tooltip",$that).css("border-radius","5px")),a.top-e.height<0?($that.addClass("wcpa_show_down"),$(".wcpa_tooltip",$that).css("bottom","-"+e.height-6+"px"),$(".wcpa_tooltip",$that).css("border-radius"," 0px 5px 5px 5px")):($(".wcpa_tooltip",$that).css("bottom",""),$that.removeClass("wcpa_show_down"))}}),0)}),(function(){$(".wcpa_tooltip",$(this)).css("left","2px"),$(".wcpa_tooltip",$(this)).css("border-radius","5px 5px 5px 0")})).addClass("wcpa_even_binded"),$("form.cart button[name=add-to-cart], form.cart .single_add_to_cart_button").not(".wcpa_even_binded").on("click",(function(e){if($(this).hasClass("disabled"))e.preventDefault();else if($(this).is(".wcpa_disable_cart"))alert(wcpa_global_vars.strings.ajax_file_upload),e.preventDefault();else{var a=!0,t=$(this).parents("form").find(".wcpa_form_outer").length>0,i=!1;if(t&&(a=wcpa_validate_form($(this).parents("form").find(".wcpa_form_outer"))),a){if(t)$(document).find(".wcpa_drag_drop input.wcpa_dynamic_file_uploader").length&&$(document).find(".wcpa_drag_drop input.wcpa_dynamic_file_uploader").remove(),i=$(this).parents("form.cart").find(".wcpa_form_outer").data("product").is_external||!1;if(wcpa_global_vars.ajax_add_to_cart&&!i){e.preventDefault();var r=$(this);r.removeClass("added"),r.addClass("loading");var n=!1,c=!1,p=$(this).parents("form.cart").find("input, select, button, textarea").wcpa_serializeArrayAll()||0;p&&($.each(p,(function(e,a){if("add-to-cart"===a.name&&a.value)return n=!0,!1})),r.attr("name")&&"add-to-cart"==r.attr("name")&&r.attr("value")&&(c=r.attr("value")),c&&!n&&p.push({name:"add-to-cart",value:c}),p.push({name:"action",value:"wcpa_ajax_add_to_cart"})),$.ajax({type:"POST",url:woocommerce_params.wc_ajax_url.toString().replace("%%endpoint%%","wcpa_ajax_add_to_cart"),data:p,success:function(e){e&&(e.error&&e.product_url?window.location=e.product_url:"undefined"==typeof wc_add_to_cart_params||void 0===wc_add_to_cart_params.cart_redirect_after_add||void 0===wc_add_to_cart_params.cart_url||"yes"!==wc_add_to_cart_params.cart_redirect_after_add?($(document.body).trigger("added_to_cart",[e.fragments,e.cart_hash,r]),"undefined"==typeof wc_add_to_cart_params&&((r=void 0!==r&&r)&&(r.removeClass("loading"),e.fragments&&r.addClass("added"),e.fragments&&!wcpa_global_vars.is_cart&&0===r.parent().find(".added_to_cart").length&&r.after('<a href="'+wcpa_global_vars.cart_url+'" class="added_to_cart wc-forward" title="'+wcpa_global_vars.i18n_view_cart+'">'+wcpa_global_vars.i18n_view_cart+"</a>"),$(document.body).trigger("wc_cart_button_updated",[r])),e.fragments&&($.each(e.fragments,(function(e){$(e).addClass("updating").fadeTo("400","0.6").block({message:null,overlayCSS:{opacity:.6}})})),$.each(e.fragments,(function(e,a){$(e).replaceWith(a),$(e).stop(!0).css("opacity","1").unblock()})),$(document.body).trigger("wc_fragments_loaded")),jQuery("body").trigger("wc_fragment_refresh"))):window.location=wc_add_to_cart_params.cart_url)},error:function(e){"undefined"==typeof wc_add_to_cart_params&&r.removeClass("loading")}})}}else if(wcpa_global_vars.disable_validation_scroll)e.preventDefault();else if(e.preventDefault(),$(".wcpa_form_outer .wcpa_validation_error:first").parents(".wcpa_form_item").offset().top){var l=$(".wcpa_form_outer .wcpa_validation_error:first").parents(".wcpa_form_item").offset().top,s=$(window).height(),o=$(".wcpa_form_outer .wcpa_validation_error:first").parents(".wcpa_form_item").outerHeight();$("html,body").animate({scrollTop:l-s/2+o/2},1e3)}}})).addClass("wcpa_even_binded"),$(".wcpa_form_outer").each((function(){var e=$(this);if(void 0!==e.data("wcpa"))return!0;if(drag_and_drop_file_upload_events(),"undefined"!=typeof wcpa_global_vars&&($(".wcpa_datepicker",e).length&&$(".wcpa_datepicker",e).each((function(){var e=$(this).data("dpconf");null==e&&(e={}),$(this).datetimepicker($.extend({timepicker:!1,validateOnBlur:!1,scrollInput:!1,dayOfWeekStart:wcpa_global_vars.start_of_week,format:wcpa_global_vars.date_format},e))})),$(".wcpa_datetimepicker",e).length&&$(".wcpa_datetimepicker",e).each((function(){var e=$(this).data("dpconf");null==e&&(e={}),$(this).datetimepicker($.extend({format:wcpa_global_vars.date_format+" "+wcpa_global_vars.time_format,validateOnBlur:!1,dayOfWeekStart:wcpa_global_vars.start_of_week,scrollInput:!1,step:15},e))})),$(".wcpa_timepicker",e).length&&$(".wcpa_timepicker",e).each((function(){var e=$(this).data("dpconf");null==e&&(e={}),$(this).datetimepicker($.extend({datepicker:!1,format:wcpa_global_vars.time_format,validateOnBlur:!1,scrollInput:!1,step:15},e))})),$(".wcpa_colorpicker",e).length&&$(".wcpa_colorpicker",e).spectrum({preferredFormat:"hex",showInput:!0,allowEmpty:!0}),void 0!==$.datetimepicker&&""!==document.documentElement.lang&&$.datetimepicker.setLocale(document.documentElement.lang.substring(0,2)),$(".wcpa_type_select .select select").each((function(){var e=!1,a=!1;($(this).hasClass("wcpa_use_sumo_individual")||wcpa_global_vars.use_sumo&&$(this).attr("multiple"))&&(e=!0,$(this).data("placeholder")&&(a=!0)),e&&(a?$(this).SumoSelect({placeholder:$(this).data("placeholder"),captionFormat:wcpa_global_vars.strings.sumo_strings.captionFormat,captionFormatAllSelected:wcpa_global_vars.strings.sumo_strings.captionFormatAllSelected}):$(this).SumoSelect({captionFormat:wcpa_global_vars.strings.sumo_strings.captionFormat,captionFormatAllSelected:wcpa_global_vars.strings.sumo_strings.captionFormatAllSelected}))}))),$([".wcpa_type_checkbox-group .wcpa_required input",".wcpa_type_radio-group .wcpa_required input",".wcpa_type_image-group .wcpa_required input",".wcpa_type_color-group .wcpa_required input",".wcpa_type_productGroup .wcpa_required input"].join(","),e).on("change",(function(){var e=$(this).parents(".wcpa_form_item");$(".wcpa_required input[type=checkbox]",e).length?0!=$(".wcpa_required input[type=checkbox]:checked",e).not(".wcpa_other").length||0!=$(".wcpa_required .wcpa_other_val",e).length&&""!=$(".wcpa_required .wcpa_other_val",e).val()?$(".wcpa_required input[type=checkbox]:first",e).removeAttr("required"):$(".wcpa_required input[type=checkbox]:first",e).attr("required","required"):$(".wcpa_required input[type=radio]",e).length&&(0!=$(".wcpa_required input[type=radio]:checked",e).not(".wcpa_other").length||0!=$(".wcpa_required .wcpa_other_val",e).length&&""!=$(".wcpa_required .wcpa_other_val",e).val()?($(".wcpa_required input[type=radio]:first",e).removeAttr("required"),$(".wcpa_required .wcpa_other_val",e).removeAttr("required")):($(".wcpa_required input[type=radio]:first",e).attr("required","required"),$(".wcpa_required input[type=radio].wcpa_other",e).is(":checked")&&$(".wcpa_required .wcpa_other_val",e).attr("required","required")))})),$(".wcpa_file_custom",e).on("keyup change",(function(){$(this).parents(".wcpa_form_item.wcpa_validate_field").length&&(wcpa_validate_form($(this).parents(".wcpa_form_outer"),$(this).parents(".wcpa_form_item"))?wcpa_upload_file($(this)):$(this).val(""))})),$(".wcpa_progress span",e).on("click",(function(){wcpa_remove_file($(this).parents(".wcpa_form_item").find(".wcpa_file_custom"))})),$(".wcpa_remove_file",e).on("click",(function(){$(this).parents(".wcpa_form_item").find(".wcpa_file_name").html(""),$(this).parents(".wcpa_form_item").find(".wcpa_file_hidden").val("").trigger("change"),$(this).parents(".wcpa_form_item").find(".wcpa_upload_preview").html(""),$(this).hide(),$(this).parents(".wcpa_form_item").find(".wcpa_file_custom").val("").trigger("change")})),$(".wcpa_clearSelection",e).on("click",(function(e){$("input",$("#"+$(this).data("element"))).prop("checked",!1),$("input",$("#"+$(this).data("element"))).trigger("change"),e.preventDefault()})),$(".image-group .wcpa_image img",e).on("click",(function(){var e=$("#"+$(this).attr("attrfor"));e.prop("checked",!e.prop("checked")),e.trigger("change")})),$(".color-group .wcpa_color label",e).on("click",(function(){var e=$("#"+$(this).attr("for")),a=e.prop("checked");setTimeout((function(){a&&(e.prop("checked",!1),e.trigger("change"))}),0),e.trigger("change")})),$(".wcpa_other_val",e).on("keyup change",(function(){$.trim($(this).val()).length>0?$(this).siblings(".wcpa_other").val("WCPAOTH "+$(this).val()):$(this).siblings(".wcpa_other").val("")})),e.on("wcpa_trigger_update",(function(a){iterate(e)})),"undefined"!=typeof wcpa_global_vars&&e.data("product").is_variable){var a="undefined"!=typeof awdajaxobject?awdajaxobject.priceGroup.data:"";e.parents("form").find(".single_variation_wrap").on("show_variation",(function(t,i){var r=e.data("product");a?(r.wc_product_price=i.display_price/r.con_unit,$.each(a,(function(e,a){"fixed"==a.type?r.wc_product_price-a.value>=0?r.wc_product_price=r.wc_product_price-a.value:r.wc_product_price=0:r.wc_product_price=r.wc_product_price-r.wc_product_price*(a.value/100)}))):r.wc_product_price=i.display_price/r.con_unit,r.stock_status=i.stock_status,r.stock_quantity=i.stock_quantity,e.data("product",r),iterate(e);var n=e.data("attrrelated");null!=n&&n.forEach((function(a){exc_relations(a,e)}))})),e.parents("form").on("reset_data",(function(a){var t=e.data("product");t.wc_product_price=t.wc_product_price_default,e.data("product",t),iterate(e)})),e.parents("form").on("reset_image",(function(a){setTimeout((function(){iterate(e)}),0)})),e.parents("form").on("woocommerce_variation_has_changed",(function(e){var a=$(this).find(".wcpa_form_outer"),t=a.data("attrrelated");null!=t&&t.forEach((function(e){exc_relations(e,a)}))}))}if($([".wcpa_has_price",".wcpa_has_price ~ .wcpa_other_val",".wcpa_has_price_related input",".wcpa_has_price_related select",".wcpa_has_price_related textarea",".wcpa_product_quantity"].join(","),e).on("keyup change",(function(){iterate(e)})),$(".wcpa_productGroup input[type=checkbox]").on('"keyup change',(function(){1==$(this).prop("checked")?($quantity_input=$(this).siblings("input.wcpa_product_quantity"),$quantity_input.prop("disabled","")):($quantity_input=$(this).siblings("input.wcpa_product_quantity"),$quantity_input.prop("disabled","disabled"))})),$(".wcpa_productGroup input[type=radio]").on('"keyup change',(function(){$radioParent=$(this).parents(".wcpa_productGroup"),$radioParent.find("input.wcpa_product_quantity").prop("disabled","disabled"),1==$(this).prop("checked")&&($quantity_input=$(this).siblings("input.wcpa_product_quantity"),$quantity_input.prop("disabled",""))})),$(".wcpa_update_product_image",e).on("keyup change",(function(){iterate(e)})),$("input[name=quantity]",e.parents("form")).length){var t=e.data("qntyrelated");null!=t&&t.forEach((function(a){exc_relations(a,e)}))}$("input[name=quantity]",e.parents("form")).on("keyup change",(function(){var a=e.data("qntyrelated");null!=a&&a.forEach((function(a){exc_relations(a,e)})),iterate(e)})),$(".wcpa_has_relation input,.wcpa_has_relation select,.wcpa_has_relation textarea",e).on("keyup change",(function(){var a=$(this).parents(".wcpa_has_relation").data("related");null!=a&&a.forEach((function(a){exc_relations(a,e)}))})),$(".wcpa_has_relation",e).each((function(){var a=$(this).data("related");null!=a&&a.forEach((function(a){exc_relations(a,e)}))})),$([".wcpa_has_label_related input",".wcpa_has_label_related select",".wcpa_has_label_related textarea"].join(","),e).on("keyup change",(function(){var a=$(this).parents(".wcpa_has_label_related").data("label_depends");null!=a&&a.forEach((function(a){exc_Label(a,e)}))})),$(".wcpa_has_label_related",e).each((function(){var a=$(this).data("label_depends");null!=a&&a.forEach((function(a){exc_Label(a,e)}))})),$(".wcpa_has_label_formula",e).removeClass("wcpa_hide"),$(".wcpa_has_value_formula",e).removeClass("wcpa_hide"),e.data("wcpa",{}),iterate(e);var i=e.data("attrrelated");null!=i&&i.forEach((function(a){exc_relations(a,e)})),$(".variations_form .variations").length&&setTimeout((function(){$(".variations_form  .variations select").trigger("change")}),0),$wcpa_helptext_change_items=$(['.wcpa_change_help_text .wcpa_image input[type="radio"]','.wcpa_change_help_text .wcpa_color input[type="radio"]','.wcpa_change_help_text .wcpa_radio input[type="radio"]'].join(","),e),$wcpa_helptext_change_items.change((function(){var e=$(this).parent().parent();if($(this).is(":checked")){var a=$(this).siblings("label").clone().children().remove().end().text();""==a&&$(this).siblings("label").find(".label_inside").length&&(a=$(this).siblings("label").find(".label_inside").clone().children().remove().end().text()),0==e.siblings(".wcpa_helptext").length?e.before('<span class="wcpa_helptext">'+a+"</span>"):e.siblings(".wcpa_helptext").text(a)}else 0!=e.siblings(".wcpa_helptext").length&&e.siblings(".wcpa_helptext").text("")})),$.each($wcpa_helptext_change_items,(function(e,a){if($(a).is(":checked")){var t=$(a).siblings("label").clone().children().remove().end().text();""==t&&$(a).siblings("label").find(".label_inside").length&&(t=$(a).siblings("label").find(".label_inside").clone().children().remove().end().text());var i=$(a).parent().parent();0==i.siblings(".wcpa_helptext").length?i.before('<span class="wcpa_helptext">'+t+"</span>"):i.siblings(".wcpa_helptext").text(t)}})),wcpa_may_update_quantity(e)})),jQuery(document.body).on("wc_booking_form_changed",(function(){var e=$(".wc-bookings-booking-cost .woocommerce-Price-amount bdi").clone().children().remove().end().text();e&&$(".wcpa_form_outer").each(((a,t)=>{$form_outer=$(t);var i=$form_outer.data("product");i.wc_product_price=parseFloat(wcpa_price(e.replace(/,/g,"."))),$form_outer.data("product",i),iterate($form_outer)}))})),jQuery(document).on("wooco_calc_price",(function(e,a,t,i){a&&$(".wcpa_form_outer").each(((e,t)=>{$form_outer=$(t);var i=$form_outer.data("product");i.wc_product_price=a,$form_outer.data("product",i),iterate($form_outer)}))}))},$(document).ready((function(){$([".wcpa_form_outer .wcpa_form_item.wcpa_validate_field input",".wcpa_form_outer .wcpa_form_item.wcpa_validate_field textarea",".wcpa_form_outer .wcpa_form_item.wcpa_validate_field select",".wcpa_form_outer .wcpa_form_item.wcpa_validate_field button"].join(",")).on("keyup change",(function(){$(this).parents(".wcpa_form_item").length&&wcpa_validate_form($(this).parents(".wcpa_form_outer"),$(this).parents(".wcpa_form_item"))}))})),$(document).ready((function(){$.wcpaInit()})),$.wcpaIterate=function(){$(".wcpa_form_outer").each((function(){iterate($(this))}))}}(jQuery),wcpa_global_vars.wcpa_init_triggers.length&&jQuery(document).on(wcpa_global_vars.wcpa_init_triggers.join(" "),(function(){jQuery.wcpaInit()})),jQuery(document).ready((function(e){setTimeout((function(){jQuery.wcpaInit()}),1e3)}));